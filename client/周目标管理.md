# DailyReview 前端工程产品说明文档

## 一、产品概述

**DailyReview** 是一款企业级周/日计划管理与进度跟踪系统，面向企业内部各部门团队，提供周目标管理、测试任务跟踪、系统配置等核心功能。

- **技术栈**：Vue 3 + Vite 6.2 + Element Plus 2.9.6
- **生产地址**：https://daily.gameyzy.com
- **路由模式**：Hash 路由（无需服务端重写规则）

---

## 二、功能模块

### 2.1 周目标管理（WeekGoal.vue）

> 入口路由：`/#/week-goal`，系统默认首页

#### 核心功能

| 功能 | 说明 |
|------|------|
| 周目标 CRUD | 按周/部门维度管理任务目标，支持新增、编辑、删除 |
| 数据统计图表 | 优先级分布饼图、状态分布饼图、人员任务柱状图 |
| Excel 批量导入 | 按部门差异化解析，支持游戏技术组/产品组/奇胜组 |
| 任务复制 | 支持复制当前筛选任务列表到剪贴板 |

#### 字段说明

| 字段 | 说明 |
|------|------|
| `weekly_goal` | 周目标内容 |
| `priority` | 优先级（S/A/B/C） |
| `executor` | 执行人 |
| `is_new_goal` | 是否新增目标（1=是，黄色高亮 `#FFF3CE`） |
| `status` | 状态（1进行中/2测试中/3已上线/4已暂停） |
| `pre_finish_date` | 预计完成日期 |
| `process` | 完成进度（0~1） |

#### 批量导入差异化说明

| 部门ID | 部门 | 导入组件 |
|--------|------|----------|
| 2 | 游戏技术 | WeekTaskBatchGame.vue |
| 3 | 奇胜组 | WeekTaskBatch.vue |
| 5 | 产品组 | WeekTaskBatchProduct.vue |

---

### 2.2 测试任务管理（TestTask.vue）

> 入口路由：`/#/test-task`

#### 核心功能

| 功能 | 说明 |
|------|------|
| Excel 导入新增任务 | 上传标准模板，批量创建测试任务 |
| 历史数据统计 | 按时间范围查询，展示任务状态/提测时间/工作量分布 |
| 任务状态跟踪 | 支持未提测/进行中/已完成/已上线/暂停五种状态 |
| 多维度图表 | 饼图（状态分布/提测时间统计/工作量）、折线图/柱状图（趋势） |
| 负责人维度聚合 | 按负责人展开，查看个人完成情况 |

#### Excel 导入字段映射

| Excel 列名 | 字段 |
|-----------|------|
| 负责人 | `responsible_person` |
| 优先级 | `priority` |
| 产品 | `product` |
| 测试内容（需求链接） | `test_content` |
| 测试状态 | `test_status` |
| 测试进度 | `test_progress` |
| 预计提测时间 | `pre_submission_time` |
| 提测时间 | `submission_time` |
| 预计上线时间 | `planned_online_time` |
| 实际上线时间 | `actual_online_time` |
| 测试实际耗时（h） | `actual_time_spent` |

---

### 2.3 系统设置（SystemSetting.vue）

> 入口路由：`/#/system-setting`

#### 核心功能

| 功能 | 说明 |
|------|------|
| 部门列表 | 下拉选择部门，默认选中 ID=2 |
| 用户管理 | 表格展示用户列表，支持编辑/新增 |
| 用户编辑 | 修改姓名、工作模式、部门、职位、状态 |

#### 用户字段说明

| 字段 | 说明 |
|------|------|
| `partner_name` | 用户姓名 |
| `mode` | 工作模式（拼搏模式/正常模式） |
| `department_id` | 所属部门 |
| `position` | 职位 |
| `is_active` | 是否激活（1/0） |

---

## 三、页面布局

```
┌────────────────────────────────────────────┐
│           顶部导航栏 MainLayout.vue          │
│  [周目标]  [测试任务]  [系统设置]  [主题切换] │
├────────────────────────────────────────────┤
│                                            │
│              路由子页面内容区                │
│                                            │
└────────────────────────────────────────────┘
```

导航组件：MainLayout.vue
- 支持移动端响应式折叠菜单（Drawer 抽屉）
- 支持暗色/亮色主题切换
- 使用 `useResponsive` 判断移动端

---

## 四、数据流与缓存

### LocalStorage 缓存键

| 键名 | 说明 | 默认值 |
|------|------|--------|
| `department_id_cache` | 当前选中部门 ID | `2` |
| `departments_user_cache` | 当前部门用户列表 JSON | `[]` |
| `all_users` | 全量用户列表 JSON | - |
| `token` | OA 系统登录 Token | - |

### API 接口汇总

| 接口 | 说明 |
|------|------|
| `UserInfoAPI.php?action=get_users` | 获取部门用户列表 |
| `UserInfoAPI.php?action=get_all_users` | 获取所有用户 |
| `UserInfoAPI.php?action=get_departments` | 获取部门列表 |
| `UserInfoAPI.php?action=update_user` | 更新用户信息 |
| `UserInfoAPI.php?action=add_user` | 新增用户 |
| `WeekGoalAPI.php?action=get` | 获取周目标列表 |
| `TestTask.php?action=create` | 新增测试任务 |

---

## 五、响应式适配

系统支持 PC 端与移动端双端适配，通过 `useResponsive` composable 统一判断：

- **PC 端**：完整表格、多列统计图、横向布局
- **移动端**：卡片式列表、折叠图例、单列布局、抽屉菜单

---

## 六、关键依赖

| 包名 | 用途 |
|------|------|
| `element-plus` | UI 组件库 |
| `vue-echarts` / `echarts` | 数据可视化图表 |
| `xlsx` | Excel 文件读取/写入 |
| `html2canvas` | 列表截图导出 |
| `axios` | HTTP 请求 |
| `vue-router` | 前端路由 |

---

## 七、未启用功能（草稿状态）

| 路由 | 组件 | 说明 |
|------|------|------|
| `/#/daily-goal` | DailyGoal.vue | 个人日目标管理 |
| `/#/history-daily` | DailyHistory.vue | 历史日计划查看 |
| `/#/user-today-plan` | UserTodayPlan.vue | 用户今日计划列表 |

> 以上路由已注册但未在导航栏展示，功能开发中或暂时停用。